name: build_docs
on: [workflow_dispatch]
jobs:
  building:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          path: CAD_Sketcher
      - uses: actions/checkout@v3
        with:
          repository: blender/blender
          path: blender-git
          submodules: "true"

      - uses: actions/setup-python@v4
        with:
          python-version: '3.10'
          cache: "pip"
      - run: pip install markdown mkdocs mkdocs-material mkdocstrings mkdocs-autorefs lightgallery mkdocstrings-python
      - run: pip install --upgrade griffe>=0.22

      - run: PYTHONPATH=$PYTHONPATH:blender-git/blender/release/scripts/modules:.

      - run: python3.10 -m mkdocs build -f ./CAD_Sketcher/mkdocs.yml
      - run: python3.10 -m mkdocs gh-deploy -f -/CAD_Sketcher/mkdocs.yml